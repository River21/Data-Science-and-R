---
title: "Team_7"
output: html_document
---
---Description----
This document describes processes of data analysis of movie.
The data came from Kofic, which is Korean Film Council.
The data is available on the urls below:
- all movies listed in Kofic (https://www.kobis.or.kr/kobis/business/mast/mvie/searchMovieList.do)
- Data related with sales rev etc.
(https://www.kobis.or.kr/kobis/business/stat/offc/searchOfficHitTotList.do?searchMode=year)

---Data Cleaning----
Before loading data, we use readxl package to load them
```{r}
#install.packages('readxl')
#install.packages('lubridate')
library(readxl)
library(lubridate)
library(dplyr)
```

At first, load data
this r codes are encoded as 'utf-8'
if errors on loading data, reopen this document with 'utf-8'
```{r}
df <- read_excel('(NEW2)(Merged) Movie Data.xlsx')
head(df)
```

Check data
```{r}
summary(df)
```
We saw unnecessary columns
Change name of column to english for easier processing
```{r}
#colnames(df)

colnames(df)[1] <- 'Name'
colnames(df)[14] <- 'Release_Date'
colnames(df)[17] <- 'Nationality'
colnames(df)[18] <- 'Total_screens'
colnames(df)[19] <- 'Box_office'
colnames(df)[20] <- 'Audience'
colnames(df)[23] <- 'Genre'
colnames(df)[24] <- 'Rate'
colnames(df)[25] <- 'Artistic'

colnames(df)
```

we decided to drop: column number 2~13, 15, 16, 21, 22
```{r}
df_edit_col <- df %>% select(Name, Release_Date, Nationality, 
                      Total_screens, Box_office, Audience,
                      Genre, Rate, Artistic)

#View(df_edit_col)
```

Convert Release Date from numeric to as.Date
```{r}
df_edit_col$Release_Date <- as.Date(df_edit_col$Release_Date, origin='1900-01-01')

#df_edit_col$Release_Date

#View(df_edit_col)
```

We skip rows with NAs
```{r}
df_skip_na <- na.omit(df_edit_col)
```

After, we identified rows with all 0s in Box Office, Audience, and # of screens.
We concluded that these are missing values or movies didn't be shown to the audience.
So, we skip these rows.
```{r}
df_skip_na_0s <- df_skip_na %>%
  filter(Total_screens > 0 & Box_office > 0 &Audience > 0)
```

Now we have 16500 rows X 9 columns data.
```{r}
nrow(df_skip_na_0s); ncol(df_skip_na_0s)
```

--------------Analysis---------------
1. Linear Regression
for this part, we are going to identify relationship among Box Office and other factors.
We set
a)Independent Variable = Box Office
b)Dependent Variable = # of screens, Nationality, Audience, Rate, Genre, Artistic.
```{r}
df_regression <- df_skip_na_0s
```

# of screen and Audience are already numeric values, so we don't need to modifying them.
However, Nationality, Genre, Rate and Artistic is characters. So we need to separate those values into each column.


Before that, when we checked Rate column, it has values with same meaning but different expression. It was derived from modification of rate system for time change.
We need to consolidate those expressions into one.
```{r}
#unique(df_regression)
```


```{r}
df_regression[df_regression["Rate"] == '12세이상관람가',"Rate"] = "Over_12"
df_regression[df_regression["Rate"] == '국민학생관람불가',"Rate"] = "Over_12"
df_regression[df_regression["Rate"] == '전체관람가',"Rate"] = "All"
df_regression[df_regression["Rate"] == '15세관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '15세이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '중학생이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '12세이상관람가,12세관람가',"Rate"] = "Over_12"
df_regression[df_regression["Rate"] == '18세 미만인 자는 관람할 수 없는 등급',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '18세관람가,15세이상관람가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '연소자관람불가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '청소년관람불가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '12세관람가',"Rate"] = "Over_12"
df_regression[df_regression["Rate"] == '15세 미만인 자는 관람할 수 없는 등급',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '고등학생이상관람가',"Rate"] = "Over_16"
df_regression[df_regression["Rate"] == '12세이상관람가,연소자관람가',"Rate"] = "Over_12"
df_regression[df_regression["Rate"] == '15세관람가,15세이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '18세관람가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '미성년자관람불가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '15세이상관람가,중학생이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '연소자관람가',"Rate"] = "All"
df_regression[df_regression["Rate"] == '고등학생이상관람가,15세이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '연소자관람불가,청소년관람불가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '연소자관람불가,15세이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '18세관람가,청소년관람불가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '미성년자관람가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '모든 관람객이 관람할 수 있는 등급,전체관람가',"Rate"] = "All"
df_regression[df_regression["Rate"] == '12세이상관람가,전체관람가',"Rate"] = "Over_12"
df_regression[df_regression["Rate"] == '12세이상관람가,고등학생이상관람가',"Rate"] = "Over_16"
df_regression[df_regression["Rate"] == '12세이상관람가,국민학생관람불가,15세이상관람가',"Rate"] = "Over_12"
df_regression[df_regression["Rate"] == '연소자관람가,전체관람가',"Rate"] = "All"
df_regression[df_regression["Rate"] == '청소년관람불가,15세이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '모든 관람객이 관람할 수 있는 등급',"Rate"] = "All"
df_regression[df_regression["Rate"] == '12세이상관람가,15세이상관람가',"Rate"] = "Over_12"
df_regression[df_regression["Rate"] == '12세 미만인 자는 관람할 수 없는 등급',"Rate"] = "Over_12"
df_regression[df_regression["Rate"] == '12세이상관람가,15세 미만인 자는 관람할 수 없는 등급',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '12세이상관람가,중학생이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '15세이상관람가,미성년자관람불가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '연소자관람가,15세이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '청소년관람불가,12세관람가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '15세 미만인 자는 관람할 수 없는 등급 ,15세이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '15세이상관람가,전체관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '15세이상관람가,18세 미만인 자는 관람할 수 없는 등급',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '국민학생관람불가,청소년관람불가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '청소년관람불가,고등학생이상관람가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '고등학생이상관람가,청소년관람불가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '국민학생관람불가,15세이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '15세관람가,12세이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '기타',"Rate"] = "Others"
df_regression[df_regression["Rate"] == '국민학생관람불가,중학생이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '미정',"Rate"] = "Not decided"
df_regression[df_regression["Rate"] == '청소년관람불가,전체관람가',"Rate"] = "Over_18"
df_regression[df_regression["Rate"] == '전체관람가,중학생이상관람가',"Rate"] = "Over_15"
df_regression[df_regression["Rate"] == '제한상영가',"Rate"] = "Restricted"
```
```{r}
#table(df_regression$Rate)
```
```{r}
df_regression$Over_12 = df_regression$Rate == 'Over_12'
df_regression$All = df_regression$Rate == 'All'
df_regression$Over_16 = df_regression$Rate == 'Over_16'
df_regression$Over_15 = df_regression$Rate == 'Over_15'
df_regression$Over_18 = df_regression$Rate == 'Over_18'
```

```{r}
#table(df_regression$Genre)
```
```{r}
df_regression$SF = df_regression$Genre == 'SF'
df_regression$Family = df_regression$Genre == '가족'
df_regression$Play = df_regression$Genre == '공연'
df_regression$Horror = df_regression$Genre == '공포(호러)'
df_regression$Others = df_regression$Genre == '기타'
df_regression$Documentary = df_regression$Genre == '다큐멘터리'
df_regression$Drama = df_regression$Genre == '드라마'
df_regression$Romans = df_regression$Genre == '멜로/로맨스'
df_regression$Musical = df_regression$Genre == '뮤지컬'
df_regression$Mystery = df_regression$Genre == '미스터리'
df_regression$Crime = df_regression$Genre == '범죄'
df_regression$Historic = df_regression$Genre == '사극'
df_regression$Western = df_regression$Genre == '서부극(웨스턴)'
df_regression$Erotic = df_regression$Genre == '성인물(에로)'
df_regression$Thriller = df_regression$Genre == '스릴러'
df_regression$Animation = df_regression$Genre == '애니메이션'
df_regression$Action = df_regression$Genre == '액션'
df_regression$Adventure = df_regression$Genre == '어드벤처'
df_regression$War = df_regression$Genre == '전쟁'
df_regression$Comedy = df_regression$Genre == '코미디'
df_regression$Fantasy = df_regression$Genre == '판타지'
```




```{r}
#table(df_regression$Nationality)
```
Nationalities of USA, Japan, and Korea occupy most of the movies filmed in Korea.
So, in this regression, we just focus on whether this movie is made in USA, Japan, or Korea.
```{r}
df_regression[df_regression["Nationality"] == '미국',"Nationality"] = "USA"
df_regression[df_regression["Nationality"] == '한국',"Nationality"] = "Korea"
df_regression[df_regression["Nationality"] == '일본',"Nationality"] = "Japan"
```

```{r}
df_regression$USA = df_regression$Nationality == 'USA'
df_regression$Japan = df_regression$Nationality == 'Japan'
df_regression$Korea = df_regression$Nationality == 'Korea'
```

```{r}
#df_regression
```
We make new columns for Column: Artistic. It has two values: Artistic or Normal.
```{r}
#table(df_regression$Artistic)
```
```{r}
df_regression[df_regression["Artistic"] == '독립/예술영화',"Artistic"] = "Artistic"
df_regression[df_regression["Artistic"] == '일반영화',"Artistic"] = "Not_artistic"
```
```{r}
df_regression$Artistic = df_regression$Artistic == 'Artistic'
df_regression$Not_artistic = df_regression$Artistic == 'Not_artistic'
```
```{r}
#View(df_regression)
```


Now, it's time to build regression model.
```{r}
Movie_reg <- lm(Box_office ~ Audience + Total_screens +All + Over_12 + Over_15 + Over_16+ Over_18 + SF + Family + Play + Horror + Documentary + Drama + Romans + Musical + Mystery + Crime + Historic + Western + Erotic + Thriller + Animation + Action + Adventure + War + Comedy + Fantasy + USA + Japan + Korea + Artistic + Not_artistic, data=df_regression)

summary(Movie_reg)
```

